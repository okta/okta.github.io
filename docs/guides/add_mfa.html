<!doctype html>
<!--[if lt IE 7 ]> <html class="ie6 no-flexbox"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie7 no-flexbox"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie8 no-flexbox"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie9 no-flexbox"> <![endif]-->
<!--[if IE 10 ]>    <html class="ie10 no-flexbox"> <![endif]-->
<!--[if (gt IE 10)|!(IE)]><!--> <html class=""> <!--<![endif]-->
<head>
	
	<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="/favicon.ico">
	<title>Add Multi-Factor Authentication to your App with the Okta Platform | Okta Developer</title>
	<meta name="description" content="An introduction to using Okta's Multi-Factor Authentication (MFA) API to add MFA to an existing application.">

	<link rel="canonical" href="http://developer.okta.com/docs/guides/add_mfa.html">

	<link rel="stylesheet" href="/assets/vendor/font-awesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="/assets/css/animate.css">
	<link rel="stylesheet" href="/assets/css/master.css">
	<link rel="stylesheet" href="/assets/css/layout-docs.css">
	<link rel="stylesheet" href="/assets/css/responsive.css">


  
	<script type="text/javascript" defer="defer" src="/assets/js/jquery.min.js"></script>
	<script type="text/javascript" defer="defer" src="/assets/js/tabber.js"></script>
	<script type="text/javascript" defer="defer" src="/assets/js/pacnav.js"></script>
	<script type="text/javascript" defer="defer" src="/assets/js/master.js"></script>
	<script type="text/javascript" defer="defer" src="/assets/js/scrollspy.js"></script>

	<script type="text/javascript" defer="defer" src="/assets/js/docs.js"></script>
	<!-- TypeKit -->
	<script src="//use.typekit.net/pls8pog.js"></script>
	<script>try{Typekit.load();}catch(e){}</script>
	<!-- GA -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-15777010-3', 'auto');
		ga('send', 'pageview');
	</script>
</head>

	
<body>
	
	<header class="site-header">
	<div class="wrap">

		<h1 class="site-title"><a href="/">Okta Developer</a></h1>

		<nav id="primary-nav" class="site-nav loaded">
			<ul>
				<li><a href="/product/">Product</a></li>
				<li><a href="/pricing/">Pricing</a></li>
				<li><a href="/customers/">Customers</a></li>
				<li><a href="/docs/guides/overview.html">Docs</a></li>
				<li><a href="/discussion/">Discussion</a></li>
				<li class="has-dropdown"><a href="#">Support</a>
					<div class="dropdown-window">
						<p class="stack-overflow">
							Post your question on <a href="http://stackoverflow.com/search?q=okta" target="_blank">Stack Overflow</a>.<br />
							We'll answer it within 24 hours.
						</p>
						<p class="email">
							Email us:<br />
							<a href="mailto:developers@okta.com">developers@okta.com</a>
						</p>
						<p class="tel">
							Call us:<br />
							<a href="tel:18887227871">1 (888) 722-7871</a>
						</p>
					</div>
				</li>
			</ul>
		</nav>

		<a href="/search" class="gsc-trigger search-button"></a>


		<div class="search-container">
			<div class="gsc-container">
				<script defer="defer">
					(function() {
						var cx = '005121479574088032773:mmh_vhv8uns';
						var gcse = document.createElement('script');
						gcse.type = 'text/javascript';
						gcse.async = true;
						gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
						'//cse.google.com/cse.js?cx=' + cx;
						var s = document.getElementsByTagName('script')[0];
						s.parentNode.insertBefore(gcse, s);
					})();
				</script>
				<gcse:searchbox-only resultsUrl="/search" enableAutoComplete="true"></gcse:searchbox-only>
			</div>
		</div>
		<a href="https://www.okta.com/developer/signup/" class="cta-button button--small">Get Started</a>

	</div>
</header>

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-P6JKVN"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P6JKVN');</script>
<!-- End Google Tag Manager -->


	
	<div class="page-content">
		
		
			
		

<section class="section--with-sidebar docs-page">
	<aside id="sidebar-wrapper-aside" class="sticky-nav--sidebar">

		



<!-- Work around to remove blank lines -->
<div class="scrollable">
	<span class="toggle-menu"></span>
	<div id="sidebar-wrapper">
		<div class="docs-sidebar-block" id="myScrollspy" >
		<h2>Guides</h2>                                                                                                        <ul class="nav sidebar-nav" data-item="saml_guidance" data-section=""><li data-name="Single Sign-On with Okta" ><a href="/docs/guides/saml_guidance.html">Single Sign-On with Okta</a></li></ul>                                                <ul class="nav sidebar-nav" data-item="oan_guidance" data-section=""><li data-name="Okta Application Network" ><a href="/docs/guides/oan_guidance.html">Okta Application Network</a></li></ul>                                                                <ul class="nav sidebar-nav" data-item="okta_mobile_connect" data-section=""><li data-name="Okta Mobile Connect" ><a href="/docs/guides/okta_mobile_connect.html">Okta Mobile Connect</a></li></ul>                                                                                <ul class="nav sidebar-nav" data-item="spring_security_saml" data-section=""><li data-name="Spring Security SAML (Java)" ><a href="/docs/guides/spring_security_saml.html">Spring Security SAML (Java)</a></li></ul>                                            <ul class="nav sidebar-nav" data-item="pysaml2" data-section=""><li data-name="PySAML2 (Python)" ><a href="/docs/guides/pysaml2.html">PySAML2 (Python)</a></li></ul>                      <ul class="nav sidebar-nav nav-title"><li data-name="Add Multi-Factor Authentication to your App with the Okta Platform" ><a id="toc_current_doc" href="/docs/guides/add_mfa.html">Add Multi-Factor Authentication to your App with the Okta Platform</a></li></ul><div id="gen-toc-container"><div class="gen-toc" id="gen-toc"><div class="gen-toc-title hide"><h2><div id="gen-toctitle" class="caret2 hide">Add Multi-Factor Authentication to your App with the Okta Platform</div></h2></div><ul class="nav sidebar-nav hide"><li class="gen-toc_level-1 toc_section-1"><a href="#introduction"><span class="gen-toctext">Introduction</span></a></li><li class="gen-toc_level-1 toc_section-2"><a href="#setting-up-your-okta-org-for-mfa"><span class="gen-toctext">Setting up your Okta org for MFA</span></a><ul class="closed"><li class="gen-toc_level-2 toc_section-3"><a href="#enabling-mfa-in-your-okta-org"><span class="gen-toctext">Enabling MFA in your Okta org</span></a></li><li class="gen-toc_level-2 toc_section-4"><a href="#creating-an-api-token-for-your-okta-org"><span class="gen-toctext">Creating an API token for your Okta org</span></a></li><li class="gen-toc_level-2 toc_section-5"><a href="#set-up-postman"><span class="gen-toctext">Set up Postman</span></a></li></ul></li><li class="gen-toc_level-1 toc_section-6"><a href="#test-postman"><span class="gen-toctext">Test Postman</span></a></li><li class="gen-toc_level-1 toc_section-7"><a href="#create-a-test-user"><span class="gen-toctext">Create a test user</span></a></li><li class="gen-toc_level-1 toc_section-8"><a href="#adding-mfa"><span class="gen-toctext">Adding MFA</span></a><ul class="closed"><li class="gen-toc_level-2 toc_section-9"><a href="#adding-a-factor-to-a-user-account"><span class="gen-toctext">Adding a factor to a user account</span></a></li><li class="gen-toc_level-2 toc_section-10"><a href="#enroll-the-factor"><span class="gen-toctext">Enroll the factor</span></a></li><li class="gen-toc_level-2 toc_section-11"><a href="#verifying-the-factor"><span class="gen-toctext">Verifying the factor</span></a></li></ul></li></ul></div></div>                                                                                                              <ul class="nav sidebar-nav" data-item="setting_up_a_saml_application_in_okta" data-section=""><li data-name="Setting up a SAML application in Okta" ><a href="/docs/guides/setting_up_a_saml_application_in_okta.html">Setting up a SAML application in Okta</a></li></ul>        
		</div>
	</div>
</div>

	</aside>

	<div id="docs-body" class="body docs-body">

		<nav id="sticky-nav" class="sticky-nav--top">

			
	<a  class="on"  href="/docs/guides/overview.html">
		Guides
	</a>
	<a  href="/docs/api/getting_started/design_principles.html">
		API
	</a>
	<a  href="/docs/sdk/core/api.html">
		SDKs
	</a>
	<a  href="/docs/examples/session_cookie.html">
		Examples
	</a>

		</nav>

		<a href="#docs-body" id="scroll-top-button">Scroll to Top</a>

		
		<header>
			<a href="https://github.com/okta/okta.github.io/tree/master/_source/docs/guides/add_mfa.md" target="_blank" class="btn btn-default btn-sm btn-github"><i class="fa fa-github"></i> Edit on GitHub</a>
			<h1 class="h3">Add Multi-Factor Authentication to your App with the Okta Platform</h1>
		</header>
		

		<ul class="list-unstyled toc" id="markdown-toc">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#prerequisites">Prerequisites</a></li>
  <li><a href="#overview-of-api-calls-used-for-multi-factor-authentication">Overview of API calls used for multi-factor authentication</a>    <ul>
      <li><a href="#setting-up-your-okta-org-for-mfa">Setting up your Okta org for MFA</a>        <ul>
          <li><a href="#enabling-mfa-in-your-okta-org">Enabling MFA in your Okta org</a></li>
          <li><a href="#creating-an-api-token-for-your-okta-org">Creating an API token for your Okta org</a></li>
          <li><a href="#set-up-postman">Set up Postman</a></li>
        </ul>
      </li>
      <li><a href="#test-postman">Test Postman</a></li>
      <li><a href="#create-a-test-user">Create a test user</a></li>
      <li><a href="#adding-mfa">Adding MFA</a>        <ul>
          <li><a href="#adding-a-factor-to-a-user-account">Adding a factor to a user account</a></li>
          <li><a href="#enroll-the-factor">Enroll the factor</a></li>
          <li><a href="#verifying-the-factor">Verifying the factor</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#learn-more">Learn more</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>Application developers and organizations are increasingly
implementing multi-factor authentication to add an extra layer of
security to their applications.</p>

<blockquote class="twitter-tweet" lang="en">
<p>In all my years working in this industry I&#39;ve seen exactly 2
effective security technologies stand the test of time: firewalls
and 2fa</p>&mdash; Chris Rohlf (@chrisrohlf)
<a href="&lt;https://twitter.com/chrisrohlf/status/574639358101352449&gt;">
March 8, 2015</a>
</blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>In this guide, we’ll show you how to add multi-factor authentication
to your app with the Okta Platform.</p>

<p>The Okta Platform gives you the flexibility to deploy Okta’s built-in
factors, or integrate with existing tokens. Native factors include
SMS, and the Okta Verify app for iOS and Android. Integrations include
Google Authenticator, RSA SecurID, Symantec VIP, and Duo Security.</p>

<p>Let’s get started!</p>

<iframe src="https://player.vimeo.com/video/123445568" width="500" height="281" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>

<h1 id="prerequisites">Prerequisites</h1>

<p>To follow along with this guide, you will need to have your own Okta Developer Edition org and have Postman configured to make API requests to that account.</p>

<ol>
  <li>Creating your Okta Developer Edition org
If you don’t already have one, create your own Okta Developer
Edition org by visiting: <a href="https://www.okta.com/developer/signup/">https://www.okta.com/developer/signup/</a>
and following the instructions.</li>
  <li>Setting up the Postman API client
After you have logged in to your account in your Okta Developer
Edition org, follow the
<a href="http://developer.okta.com/docs/getting_started/api_test_client.html">instructions on the Okta Developer Documentation page for setting up Postman</a>.</li>
</ol>

<h1 id="overview-of-api-calls-used-for-multi-factor-authentication">Overview of API calls used for multi-factor authentication</h1>

<p>Below is an introduction to using Okta’s Multi-Factor Authentication (MFA)
API to add MFA to an existing application.</p>

<p>In this guide, you will learn the actual HTTPS requests that are
involved in adding MFA to your
application. How use actually make these calls will depend on the
programming language and web framework that your application uses.</p>

<p>If you are writing code in .NET or Java, <a href="http://developer.okta.com/docs/sdk/core/api.html">Okta has helper libraries</a>
that will make it easy to add support for Okta to your application
in an idiomatic way.</p>

<p>Okta’s helper libraries can be found here: <a href="http://developer.okta.com/docs/sdk/core/api.html">http://developer.okta.com/docs/sdk/core/api.html</a></p>

<h2 id="setting-up-your-okta-org-for-mfa">Setting up your Okta org for MFA</h2>

<p>Before you can start writing code, you’ll need to make do a few
things in the Admin interface to your Okta org.</p>

<ol>
  <li>Enable support for MFA.</li>
  <li>Create an API token.</li>
</ol>

<h3 id="enabling-mfa-in-your-okta-org">Enabling MFA in your Okta org</h3>

<p>You must enable MFA from the Admin
interface of your Okta org before you can use it from the
Okta API. Here is how to enable MFA for
your Okta org:</p>

<ol>
  <li>Log in to your Okta org as a user with administration.</li>
  <li>Click the “Admin” button to get into the Admin interface.</li>
  <li>Open the “Security” menu.</li>
  <li>Select “Authentication” from the menu.</li>
  <li>Click on “Multifactor”.</li>
  <li>Click the “Edit” button in the “Factor Types” section.</li>
  <li>Check the check boxes next to “Google Authenticator” and “SMS
Authentication”.</li>
  <li>Click the green “Save” button.</li>
</ol>

<h3 id="creating-an-api-token-for-your-okta-org">Creating an API token for your Okta org</h3>

<p>Requests made to the Okta API are authenticated via an API
token. Here is how to create an API token for your Okta
org:</p>

<ol>
  <li>Log in to your Okta org as a user with administration.</li>
  <li>Click the “Admin” button to get into the Admin interface.</li>
  <li>Open the “Security” menu.</li>
  <li>Select “API” from the menu.</li>
  <li>Click the “Create Token” button.</li>
  <li>Enter “Postman” (or something more descriptive) into the text field.</li>
  <li>Click the green “Create Token” button.</li>
  <li>Configure Postman to use the Token you just created.</li>
</ol>

<h3 id="set-up-postman">Set up Postman</h3>

<p>If you haven’t set up Postman already, you will need to do that
now. Here are <a href="http://developer.okta.com/docs/getting_started/api_test_client.html">instructions for setting up Postman to work with Okta</a>.</p>

<h2 id="test-postman">Test Postman</h2>

<p>Before you get started, you will want to make sure your Postman
setup is configured correctly, a “<a href="https://en.wikipedia.org/wiki/%22Hello,_World!%22_program">Hello World</a>” of sorts. Test your
Postman setup as follows:</p>

<ol>
  <li>Open Postman.</li>
  <li>Open the “Collections” section in Postman.</li>
  <li>Select the “Users (Okta API)” collection.</li>
  <li>Scroll until you see the “GET List Users” request template.</li>
  <li>Select the “GET List Users” request template.</li>
  <li>Click the blue “Send” button.</li>
</ol>

<p>You’ll know it is working if you get back JSON containing one or more user objects.</p>

<h2 id="create-a-test-user">Create a test user</h2>

<p>The first step in adding MFA to an existing
application is to create a user account in Okta. Among other
things, creating a user account in Okta allows you to add
MFA to your application without needing to
update your user schemas.</p>

<p>For the purposes of this demonstration, we will be creating a
random user generated using the <a href="https://randomuser.me/">Random User Generator</a> website:</p>

<ol>
  <li>Generate a random user by loading <a href="https://randomuser.me">https://randomuser.me</a> in
your browser.</li>
  <li>Copy the random user’s data from the website to somewhere you
can refer to later:
    <ul>
      <li>First Name</li>
      <li>Last Name</li>
      <li>Email Address</li>
    </ul>
  </li>
  <li>Open the “Users (Okta API)” collection in Postman.</li>
  <li>Create a user using the “POST Create User without Credentials”
request template in Postman.</li>
  <li>Save the value of the “id” (the User ID) that is returned by Postman, you will
be using this ID a lot. (In Okta, User ID’s start with “00u”)</li>
</ol>

<h2 id="adding-mfa">Adding MFA</h2>

<p>Now that you have created a user account in Okta, you are ready to
setup MFA for that user account. A key part of enabling MFA for a
user is actually verifying that they have a MFA token. In Okta,
this process is known as “Enrollment”. Once a MFA token has been
enrolled, we can then “Verify” that they actually have this token
by asking them to answer a challenge using their token.</p>

<p>The process attaching a factor to a user is similar for every type
of factor that Okta supports. In the video we show how to attach a
Google Authenticator factor as well as a phone as a factor using
SMS. In this document we will only cover how to attach a Google
Authenticator factor.</p>

<p>At a high level, the process of attaching a factor to an account is
similar for all factors an works as follows:</p>

<ol>
  <li>Add a factor to the user account.</li>
  <li>Enroll the factor.</li>
</ol>

<p>Once the factor has been enrolled, you can verify it as needed.</p>

<h3 id="adding-a-factor-to-a-user-account">Adding a factor to a user account</h3>

<p>Using the User ID that you created earlier, add a Google
Authenticator factor to that user as follows:</p>

<ol>
  <li>Open the “Factors (Okta API)” collection in Postman.</li>
  <li>Add a new Google Authenticator Factor to your user with the
“POST Enroll Google Authenticator Factor” request template in
Postman. <strong>Important</strong>, be sure to replace the “”
template in the request URL with the User ID for the user you
created previously.</li>
  <li>Save the value of the “id” (the Factor ID) that is returned by
Postman, you will be using this id in the next step.</li>
  <li>Copy the URL located in the “href” value of the “qrcode” link
found in the “_embedded” object located at the bottom of the
response in Postman. Open this URL in a new tab of your
favorite browser.</li>
</ol>

<h3 id="enroll-the-factor">Enroll the factor</h3>

<p>After adding a factor to an Okta user, the next step is to have
the user setup their factor and then prove that they have done
that by answering a challenge with their token.</p>

<p>Continuing on from the steps above:</p>

<ol>
  <li>Open Google Authenticator on your phone.</li>
  <li>Tap the “+” button in Google Authenticator.</li>
  <li>Select the “Scan barcode” option.</li>
  <li>Scan the QR Code on the browser tab you opened previously.</li>
  <li>Switch to Postman on your computer.</li>
  <li>From the “Factors (Okta API)” collection, select the “POST
Activate TOTP Factor” request template.</li>
  <li>Replace the “” and “” templates with the
User ID and Factor ID values that you’ve copied previously.</li>
  <li>In the JSON body, replace the “passCode” value with the
passcode shown on Google Authenticator.</li>
  <li>Click the blue “Send” button.</li>
</ol>

<h3 id="verifying-the-factor">Verifying the factor</h3>

<p>Now that you’ve verified the factor, you are ready to start
verifying MFA tokens! Here is how to do that using Postman:</p>

<ol>
  <li>Open the “Factors (Okta API)” collection in Postman.</li>
  <li>Select the “POST Verify TOTP Factor” request template.</li>
  <li>Replace the “” and “” templates with the
User ID and Factor ID values that you’ve copied previously.</li>
  <li>In the JSON body, replace the “passCode” value with the
passcode shown on Google Authenticator.</li>
  <li>Click the blue “Send” button.</li>
  <li>A successful verification of a token will result in an HTTP
status code of 200, with a JSON payload containing the key
“factorResult” with the value of “SUCCESS”.
(Unsuccessful verification attempts will result in an HTTP
status code of 403, with a JSON payload containing the key “errorCode”).</li>
</ol>

<h1 id="learn-more">Learn more</h1>

<p>At this point, you should understand how to use the Okta API to add
MFA to an existing application. You can learn more about using the
Okta MFA API with the following resources.</p>

<ul>
  <li>The video in this guide.
These instructions only cover part of what is covered in the video.</li>
  <li>The <a href="http://developer.okta.com/docs/getting_started/design_principles.html">design principles for the Okta API</a>.</li>
  <li>The API documentation for the <a href="http://developer.okta.com/docs/api/rest/factors.html">Okta Factors API</a>.</li>
  <li>The API documentation for the <a href="http://developer.okta.com/docs/api/rest/authn.html">Okta Authentication API</a>.</li>
</ul>

	</div>
	
<!-- Remarketing tag -->
	<script type="text/javascript">
		/* <![CDATA[ */
		var google_conversion_id = 1006913831;
		var google_custom_params = window.google_tag_params;
		var google_remarketing_only = true;
		/* ]]> */
	</script>
	<script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
	</script>
	<noscript>
		<div style="display:inline;">
			<img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/1006913831/?value=0&amp;guid=ON&amp;script=0"/>
		</div>
	</noscript>
<!-- End Remarketing tag -->

<!-- Crazy Egg Tracking -->
<script type="text/javascript">
setTimeout(function(){var a=document.createElement("script");
var b=document.getElementsByTagName("script")[0];
a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0021/9333.js?"+Math.floor(new Date().getTime()/3600000);
a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
</script>
<!-- End Crazy Egg Tracking -->

<footer class="site-footer">
	<div class="wrap">

		<ul>
			<li><a href="http://www.okta.com" target="_blank">Okta.com</a></li>
			<li><a href="/blog">Blog</a></li>
			<li><a href="/terms/">Terms &amp; Conditions</a></li>
			<li><a href="/privacy/">Privacy Policy</a></li>
			<li><a href="http://okta.com/developer/contact/">Contact Sales</a></li>
			<li><a href="mailto:developers@okta.com">Contact Support</a></li>
		</ul>

		<ul>
			<li><a class="icon-with-hover--github" href="http://github.com/okta" target="_blank">Github</a></li>
			<li><a class="icon-with-hover--twitter" href="http://twitter.com/okta" target="_blank">Twitter</a></li>
			<li><a class="icon-with-hover--stack-overflow" href="http://stackoverflow.com/search?q=okta" target="_blank">Stack Overflow</a></li>
			<li><a class="icon-with-hover--rss" href="http://feeds.feedburner.com/OktaBlog" target="_blank">News</a></li>
			<li><a class="icon-with-hover--help" href="http://community.okta.com" target="_blank">Help</a></li>
		</ul>

	</div>
</footer>

</section>
		
		
			
	</div>	
</body>
	
</html>