<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
<head>
  <script>
    var isProduction = window.location.hostname === 'developer.okta.com';
    if (isProduction) {
      // TypeKit
      (function(d) {
        var config = {
          kitId: 'jff5neq',
          scriptTimeout: 3000,
          async: true
        },
        h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
      })(document);

      // Google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-15777010-3', 'auto');
      ga('send', 'pageview');

      // START Google Tag Manager
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TJ45R6');
      // END Google Tag Manager
    }
	</script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
 	
  <link type="text/css" rel="stylesheet" href="/assets/animate-ec43d72c3ed45e08a460b8a2966d8dba6006aebfa0530935c3973fa493a8771f.css">
  <link type="text/css" rel="stylesheet" href="/assets/okta-c9d8d47e5d0b2c3f60c41beea5371ccb83174ddc23c0f090acf1ae9a6735cb31.css">
  
  
  <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/favicon.ico">
  <title>Multi-Factor Authentication | Okta Developer</title>
  <meta name="description" content="Using Okta's Multi-Factor Authentication API to add MFA to an existing application.">
  <link rel="canonical" href="https://developer.okta.com/use_cases/mfa/index">
  <link rel="alternate" type="application/rss+xml" title="Okta Developer" href="https://developer.okta.com/feed.xml"><!-- GA -->
</head>

<body>
  <div class="Page multi-factor-authentication">
    <!-- START Header -->
    
<header id="header">
      <div class="Wrap">
        <h1 class="logo"><a href="/">Okta</a></h1><!-- START Primary Nav -->
        <nav>
          <div id="top-nav">
            <a href="#" id="mobile-close" class="mobile-toggle">
              <span></span>
              <span></span>
            </a>
            <a class="Button--green" href="https://developer.okta.com/signup/" id="top-nav-cta">Get Started</a>
            <a class="SearchIcon" href="#"></a>
            <ul>
              <li>
                <a href="/product/">Product</a>
              </li>
              <li>
                <a href="/documentation/">Documentation</a>
              </li>
              <li>
                <a href="/code/">Code</a>
              </li>
              <li class="has-dropdown">
                <a href="#">Support</a>
                <div class="dropdown-window">
                  <p class="devforum">Post your question on <a href="https://devforum.okta.com/" title="Okta Developer Forums" target="_blank">Okta Developer Forums</a></p>
                  <p class="email">Email us:<br>
                  <a href="mailto:developers@okta.com">developers@okta.com</a></p>
                  <p class="tel">Call us:<br>
                  <a href="tel:18887227871">1 (888) 722-7871</a></p>
                </div>
              </li>
            </ul>
            <form id="form_search" method="get" action="/search/" name="form_search">
              <input type="text" name="q" id="q" autocomplete="off">
            </form>
          </div>
          <div id="mobile-nav">
            <a id="mobile-search" href="/search/"><span class="icon-search-light"></span></a>
            <a id="mobile-open" class="mobile-toggle" href="#top-nav">
              <span></span>
              <span></span>
              <span></span>
            </a>
          </div>
        </nav><!-- END Primary Nav -->
      </div>
    </header>

    <!-- END Header -->
     <!-- START Page Center w/Sub Nav & Content -->
    <section class="PageContent DynamicSidebar has-tableOfContents">
      <!-- START Fixed sidebar --><aside class="Sidebar">
        <h2 class="Sidebar-location Sidebar-toggle h6">Navigation</h2>
        <div class="Sidebar-close Sidebar-toggle"></div>
        <div>
          <h3 class="Sidebar-title">Use Cases</h3>
          <ul class="Sidebar-nav">
            <li>
              <a href="/use_cases/authentication/">Authentication</a>
            </li>
            <li class="is-active">
              <a href="/use_cases/mfa/">Multi-Factor Authentication</a>
            </li>
            <li>
              <a href="/use_cases/api_access_management/">API Access Management</a>
            </li>
            <li>
              <a href="/use_cases/integrate_with_okta/">Integrate with Okta</a>
            </li>
          </ul>
          <h3 class="Sidebar-title">Reference</h3>
          <ul class="Sidebar-nav">
            <li>
              <a href="/docs/api/getting_started/api_test_client.html">Getting Started</a>
            </li>
            <li>
              <a href="/docs/api/resources/authn.html">Authentication Reference</a>
            </li>
            <li>
              <a href="/docs/api/resources/apps.html">API Reference</a>
            </li>
            <li>
              <a href="/reference/error_codes/">Error Codes</a>
            </li>
            <li>
              <a href="/reference/okta_expression_language/">Okta Expression Language</a>
            </li>
            <li>
              <a href="/docs/platform-release-notes/platform-release-notes.html">Platform Release Notes</a>
            </li>
          </ul>

          <h3 class="Sidebar-title">Standards</h3>
          <ul class="Sidebar-nav">
            
            
            
            <li>
              <a href="/standards/OAuth/">OAuth 2.0 and Okta</a>
            </li>
            
            
            <li>
              <a href="/standards/OIDC/">OpenID Connect and Okta</a>
            </li>
            
            
            <li>
              <a href="/standards/SAML/">SAML</a>
            </li>
            
            
            
            
            <li>
              <a href="/standards/SCIM/">SCIM Provisioning with Lifecycle Management</a>
            </li>
            
          </ul>
          <script>
            if (document.querySelectorAll("#Sidebar_Resources .is-active").length) {
                document.getElementById('Sidebar_Resources').classList.remove('Sidebar-hide');
            }

            if (document.querySelectorAll("#Sidebar_References .is-active").length) {
                document.getElementById('Sidebar_References').classList.remove('Sidebar-hide');
            }
          </script>
        </div>
      </aside>
<!-- END Fixed sidebar -->
      <!-- START Page Content -->
      <div class="PageContent-main" id="docs-body">
        <a id="edit-link" href="https://github.com/okta/okta.github.io/edit/master/_source/_use_cases/mfa/index.md">Edit Page</a>
      <h1 id="introduction">Introduction</h1>

<p>Application developers and organizations are increasingly
implementing multi-factor authentication to add an extra layer of
security to their applications.</p>

<blockquote class="twitter-tweet" lang="en">
<p>In all my years working in this industry I&#39;ve seen exactly 2
effective security technologies stand the test of time: firewalls
and 2fa</p>&mdash; Chris Rohlf (@chrisrohlf)
<a href="https://twitter.com/chrisrohlf/status/574639358101352449">
March 8, 2015</a>
</blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>In this guide, we’ll show you how to add multi-factor authentication
to your app with the Okta Platform.</p>

<p>The Okta Platform gives you the flexibility to deploy Okta’s built-in
factors, or integrate with existing tokens. Native factors include
SMS, and the Okta Verify app for iOS and Android. Integrations include
Google Authenticator, RSA SecurID, Symantec VIP, and Duo Security.</p>

<p>Let’s get started!</p>

<iframe src="https://player.vimeo.com/video/123445568" width="500" height="281" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>

<h3 id="prerequisites">Prerequisites</h3>

<p>To follow along with this guide, you will need to have your own Okta Developer Edition org and have Postman configured to make API requests to that account.</p>

<ol>
  <li>Creating your Okta Developer Edition org
If you don’t already have one, create your own Okta Developer
Edition org by visiting: <a href="https://www.okta.com/developer/signup/">https://www.okta.com/developer/signup/</a>
and following the instructions.</li>
  <li>Setting up the Postman API client
After you have logged in to your account in your Okta Developer
Edition org, follow the
<a href="/docs/getting_started/api_test_client.html">instructions on the Okta Developer Documentation page for setting up Postman</a>.</li>
</ol>

<h1 id="overview-of-api-calls-used-for-multi-factor-authentication">Overview of API calls used for multi-factor authentication</h1>

<p>Below is an introduction to using Okta’s Multi-Factor Authentication (MFA)
API to add MFA to an existing application.</p>

<p>In this guide, you will learn the actual HTTPS requests that are
involved in adding MFA to your
application. How use actually make these calls will depend on the
programming language and web framework that your application uses.</p>

<p>If you are writing code in .NET or Java, <a href="/code/index.html">Okta has helper libraries</a>
that will make it easy to add support for Okta to your application
in an idiomatic way.</p>

<h3 id="setting-up-your-okta-org-for-mfa">Setting up your Okta org for MFA</h3>

<p>Before you can start writing code, you’ll need to make do a few
things in the Admin interface to your Okta org.</p>

<ol>
  <li>Enable support for MFA.</li>
  <li>Create an API token.</li>
</ol>

<h3 id="enabling-mfa-in-your-okta-org">Enabling MFA in your Okta org</h3>

<p>You must enable MFA from the Admin
interface of your Okta org before you can use it from the
Okta API. Here is how to enable MFA for
your Okta org:</p>

<ol>
  <li>Log in to your Okta org as a user with administration.</li>
  <li>Click the “Admin” button to get into the Admin interface.</li>
  <li>Open the “Security” menu.</li>
  <li>Select “Authentication” from the menu.</li>
  <li>Click on “Multifactor”.</li>
  <li>Click the “Edit” button in the “Factor Types” section.</li>
  <li>Check the check boxes next to “Google Authenticator” and “SMS
Authentication”.</li>
  <li>Click the green “Save” button.</li>
</ol>

<p>For more information about MFA and the Okta org, see the <a href="https://help.okta.com/en/prod/Content/Topics/Security/MFA.htm">MFA</a> and <a href="https://help.okta.com/en/prod/Content/Topics/Security/Security_Policies.htm">Security Policies</a> help topics.</p>

<h3 id="creating-an-api-token-for-your-okta-org">Creating an API token for your Okta org</h3>

<p>Requests made to the Okta API are authenticated via an API
token. Here is how to create an API token for your Okta
org:</p>

<ol>
  <li>Log in to your Okta org as a user with administration.</li>
  <li>Click the “Admin” button to get into the Admin interface.</li>
  <li>Open the “Security” menu.</li>
  <li>Select “API” from the menu.</li>
  <li>Click the “Create Token” button.</li>
  <li>Enter “Postman” (or something more descriptive) into the text field.</li>
  <li>Click the green “Create Token” button.</li>
  <li>Configure Postman to use the Token you just created.</li>
</ol>

<h3 id="set-up-postman">Set up Postman</h3>

<p>If you haven’t set up Postman already, you will need to do that
now. Here are <a href="/docs/getting_started/api_test_client.html">instructions for setting up Postman to work with Okta</a>.</p>

<h3 id="test-postman">Test Postman</h3>

<p>Before you get started, you will want to make sure your Postman
setup is configured correctly, a “<a href="https://en.wikipedia.org/wiki/%22Hello,_World!%22_program">Hello World</a>” of sorts. Test your
Postman setup as follows:</p>

<ol>
  <li>Open Postman.</li>
  <li>Open the “Collections” section in Postman.</li>
  <li>Select the “Users (Okta API)” collection.</li>
  <li>Scroll until you see the “GET List Users” request template.</li>
  <li>Select the “GET List Users” request template.</li>
  <li>Click the blue “Send” button.</li>
</ol>

<p>You’ll know it is working if you get back JSON containing one or more user objects.</p>

<h3 id="create-a-test-user">Create a test user</h3>

<p>The first step in adding MFA to an existing
application is to create a user account in Okta. Among other
things, creating a user account in Okta allows you to add
MFA to your application without needing to
update your user schemas.</p>

<p>For the purposes of this demonstration, we will be creating a
random user generated using the <a href="https://randomuser.me/">Random User Generator</a> website:</p>

<ol>
  <li>Generate a random user by loading <a href="https://randomuser.me">https://randomuser.me</a> in
your browser.</li>
  <li>Copy the random user’s data from the website to somewhere you
can refer to later:
    <ul>
      <li>First Name</li>
      <li>Last Name</li>
      <li>Email Address</li>
    </ul>
  </li>
  <li>Open the “Users (Okta API)” collection in Postman.</li>
  <li>Create a user using the “POST Create User without Credentials”
request template in Postman.</li>
  <li>Save the value of the “id” (the User ID) that is returned by Postman, you will
be using this ID a lot. (In Okta, User ID’s start with “00u”)</li>
</ol>

<h3 id="adding-mfa">Adding MFA</h3>

<p>Now that you have created a user account in Okta, you are ready to
setup MFA for that user account. A key part of enabling MFA for a
user is actually verifying that they have a MFA token. In Okta,
this process is known as “Enrollment”. Once a MFA token has been
enrolled, we can then “Verify” that they actually have this token
by asking them to answer a challenge using their token.</p>

<p>The process attaching a factor to a user is similar for every type
of factor that Okta supports. In the video we show how to attach a
Google Authenticator factor as well as a phone as a factor using
SMS. In this document we will only cover how to attach a Google
Authenticator factor.</p>

<p>At a high level, the process of attaching a factor to an account is
similar for all factors an works as follows:</p>

<ol>
  <li>Add a factor to the user account.</li>
  <li>Enroll the factor.</li>
</ol>

<p>Once the factor has been enrolled, you can verify it as needed.</p>

<h3 id="adding-a-factor-to-a-user-account">Adding a factor to a user account</h3>

<p>Using the User ID that you created earlier, add a Google
Authenticator factor to that user as follows:</p>

<ol>
  <li>Open the “Factors (Okta API)” collection in Postman.</li>
  <li>Add a new Google Authenticator Factor to your user with the
“POST Enroll Google Authenticator Factor” request template in
Postman. <strong>Important</strong>, be sure to replace the “”
template in the request URL with the User ID for the user you
created previously.</li>
  <li>Save the value of the “id” (the Factor ID) that is returned by
Postman, you will be using this id in the next step.</li>
  <li>Copy the URL located in the “href” value of the “qrcode” link
found in the “_embedded” object located at the bottom of the
response in Postman. Open this URL in a new tab of your
favorite browser.</li>
</ol>

<h3 id="enroll-the-factor">Enroll the factor</h3>

<p>After adding a factor to an Okta user, the next step is to have
the user setup their factor and then prove that they have done
that by answering a challenge with their token.</p>

<p>Continuing on from the steps above:</p>

<ol>
  <li>Open Google Authenticator on your phone.</li>
  <li>Tap the “+” button in Google Authenticator.</li>
  <li>Select the “Scan barcode” option.</li>
  <li>Scan the QR Code on the browser tab you opened previously.</li>
  <li>Switch to Postman on your computer.</li>
  <li>From the “Factors (Okta API)” collection, select the “POST
Activate TOTP Factor” request template.</li>
  <li>Replace the “” and “” templates with the
User ID and Factor ID values that you’ve copied previously.</li>
  <li>In the JSON body, replace the “passCode” value with the
passcode shown on Google Authenticator.</li>
  <li>Click the blue “Send” button.</li>
</ol>

<h3 id="verifying-the-factor">Verifying the factor</h3>

<p>Now that you’ve verified the factor, you are ready to start
verifying MFA tokens! Here is how to do that using Postman:</p>

<ol>
  <li>Open the “Factors (Okta API)” collection in Postman.</li>
  <li>Select the “POST Verify TOTP Factor” request template.</li>
  <li>Replace the “” and “” templates with the
User ID and Factor ID values that you’ve copied previously.</li>
  <li>In the JSON body, replace the “passCode” value with the
passcode shown on Google Authenticator.</li>
  <li>Click the blue “Send” button.</li>
  <li>A successful verification of a token will result in an HTTP
status code of 200, with a JSON payload containing the key
“factorResult” with the value of “SUCCESS”.
(Unsuccessful verification attempts will result in an HTTP
status code of 403, with a JSON payload containing the key “errorCode”).</li>
</ol>

<h2 id="learn-more">Learn more</h2>

<p>At this point, you should understand how to use the Okta API to add
MFA to an existing application. You can learn more about using the
Okta MFA API with the following resources.</p>

<ul>
  <li>The video in this guide.
These instructions only cover part of what is covered in the video.</li>
  <li>The <a href="/docs/getting_started/design_principles.html">design principles for the Okta API</a>.</li>
  <li>The API documentation for the <a href="/docs/api/rest/factors.html">Okta Factors API</a>.</li>
  <li>The API documentation for the <a href="/docs/api/rest/authn.html">Okta Authentication API</a>.</li>
</ul>

      </div>
      <div class="TableOfContents TableOfContentsPreload">
        <div class="TableOfContents-item is-level1">
          <script>
                  document.write(document.title.split('|')[0].trim());
          </script>
        </div>
        <div class="TableOfContentsLoader"></div>
      </div><!-- END Page Content -->
    </section><!-- END Page Center w/Sub Nav & Content -->

    <!-- START Footer -->
    <footer class="footer">
      <div class="Wrap">
        <ul>
          <li>
            <a href="https://www.okta.com" target="_blank">Okta.com</a>
          </li>
          <li>
            <a href="/blog/">Blog</a>
          </li>
          <li>
            <a href="/docs/platform-release-notes/platform-release-notes.html">Platform Release Notes</a>
          </li>
          <li>
            <a href="/terms/">Terms & Conditions</a>
          </li>
          <li>
            <a href="/3rd_party_notices/">3rd Party Notices</a>
          </li>
          <li>
            <a href="/privacy/">Privacy Policy</a>
          </li>
          <li>
            <a href="/contact/">Contact Sales</a>
          </li>
          <li>
            <a href="mailto:developers@okta.com">Contact Support</a>
          </li>
        </ul>
        <ul>
          <li>
            <a class="icon" href="http://github.com/oktadeveloper" target="_blank"><i class="fa fa-github"></i></a>
          </li>
          <li>
            <a class="icon" href="http://twitter.com/okta" target="_blank"><i class="fa fa-twitter"></i></a>
          </li>
          <li>
            <a class="icon" href="https://devforum.okta.com/" title="Okta Developer Forums" target="_blank"><i class="fa fa-comments"></i></a>
          </li>
          <li>
            <a class="icon" href="http://feeds.feedburner.com/OktaBlog" target="_blank"><i class="fa fa-rss"></i></a>
          </li><!-- <li><a class="icon" href="http://community.okta.com" target="_blank"><i class="fa fa-comments"></i></a></li> -->
        </ul>
      </div>
    </footer>
    <script type="text/javascript" src="/assets/master-d164e3cb90ad42ea74c141546269db0efdbc2259b7d44b7f52babb60097099a8.js"></script>
    
    
    
    
      <script type="text/javascript" src="/assets/docs-a2d1c410ee8c45eaa505f76f4f72815741c3bb6532081ae1abe25e3d8d00f4fa.js"></script>
    

    <!-- END Footer -->
  </div>
  <!-- START Post Footer -->
  
  <!-- START Google Tag Manager -->
  <!-- https://support.google.com/tagmanager/answer/6103696?hl=en -->
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- END Google Tag Manager -->
  <!-- START Google Remarketing Tag -->
  <script type="text/javascript">
    /* <![CDATA[ */
    var google_conversion_id = 1006913831;
    var google_custom_params = window.google_tag_params;
    var google_remarketing_only = true;
    /* ]]> */
  </script>
  <div style="display:none;"><script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js"></script></div>
  <noscript><div style="display:inline;"><img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/1006913831/?value=0&amp;guid=ON&amp;script=0"></div></noscript>
  <!-- END Google Remarketing Tag -->
  <!-- START Crazy Egg Tracking -->
  <script type="text/javascript">
    setTimeout(function(){var a=document.createElement("script");
    var b=document.getElementsByTagName("script")[0];
    a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0021/9333.js?"+Math.floor(new Date().getTime()/3600000);
    a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>
  <!-- END Crazy Egg Tracking -->

  <!-- END Post Footer -->
</body>
</html>
