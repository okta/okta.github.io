<!doctype html>
<!--[if lt IE 7 ]> <html class="ie6 no-flexbox"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie7 no-flexbox"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie8 no-flexbox"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie9 no-flexbox"> <![endif]-->
<!--[if IE 10 ]>    <html class="ie10 no-flexbox"> <![endif]-->
<!--[if (gt IE 10)|!(IE)]><!--> <html class="modern wf-loading" lang="en"> <!--<![endif]-->
  <head><head>
  <script>
    var isProduction = window.location.hostname === 'developer.okta.com';
    if (isProduction) {
      // TypeKit
      (function(d) {
        var config = {
          kitId: 'jff5neq',
          scriptTimeout: 3000,
          async: true
        },
        h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
      })(document);

      // Google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-15777010-3', 'auto');
      ga('send', 'pageview');

      // START Google Tag Manager
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TJ45R6');
      // END Google Tag Manager
    }
	</script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
 	
  <link type="text/css" rel="stylesheet" href="/assets/animate-ec43d72c3ed45e08a460b8a2966d8dba6006aebfa0530935c3973fa493a8771f.css">
  <link type="text/css" rel="stylesheet" href="/assets/okta-fe3337502d4360bcb36814ced8dd4f88ec4c9e7d7a0be6fa2995c3524314aa7d.css">
  
  
    <link type="text/css" rel="stylesheet" href="/assets/page-blog-367850afad8093d512ce46256493ec36aa919ccb2ed99af419063c06816ac5d8.css">
  
  <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/favicon.ico">
  <title>Angular Authentication with OpenID Connect and Okta in 20 Minutes | Okta Developer</title>
  <meta name="description" content="Angular (formerly called Angular 2.0) is quickly becoming one of the most powerful ways to build a modern single-page app. A core strength is Angular’s focus...">
  <link rel="canonical" href="https://developer.okta.com/blog/2017/04/17/angular-authentication-with-oidc">
  <link rel="alternate" type="application/rss+xml" title="Okta Developer" href="https://developer.okta.com/feed.xml"><!-- GA -->
</head>

    <body id="blog">
	
<header id="header">
      <div class="Wrap">
        <h1 class="logo"><a href="/">Okta</a></h1><!-- START Primary Nav -->
        <nav>
          <div id="top-nav">
            <a href="#" id="mobile-close" class="mobile-toggle">
              <span></span>
              <span></span>
            </a>
            <a class="Button--green" href="https://developer.okta.com/signup/" id="top-nav-cta">Get Started</a>
            <a class="SearchIcon" href="#"></a>
            <ul>
              <li>
                <a href="/product/">Product</a>
              </li>
              <li>
                <a href="/documentation/">Documentation</a>
              </li>
              <li>
                <a href="/code/">Code</a>
              </li>
              <li class="has-dropdown">
                <a href="#">Support</a>
                <div class="dropdown-window">
                  <p class="devforum">Post your question on <a href="https://devforum.okta.com/" title="Okta Developer Forums" target="_blank">Okta Developer Forums</a></p>
                  <p class="email">Email us:<br>
                  <a href="mailto:developers@okta.com">developers@okta.com</a></p>
                  <p class="tel">Call us:<br>
                  <a href="tel:18887227871">1 (888) 722-7871</a></p>
                </div>
              </li>
            </ul>
            <form id="form_search" method="get" action="/search/" name="form_search">
              <input type="text" name="q" id="q" autocomplete="off">
            </form>
          </div>
          <div id="mobile-nav">
            <a id="mobile-search" href="/search/"><span class="icon-search-light"></span></a>
            <a id="mobile-open" class="mobile-toggle" href="#top-nav">
              <span></span>
              <span></span>
              <span></span>
            </a>
          </div>
        </nav><!-- END Primary Nav -->
      </div>
    </header>

	<div class="page-content">
		<section id="blog-post" class="main-container">
	<div class="wrap blog">
		<section >
  <div class="wrap">
    <article class="post-block">
      <header class="post-title-block">
        <h1><a href="/blog/2017/04/17/angular-authentication-with-oidc">Angular Authentication with OpenID Connect and Okta in 20 Minutes</a></h1>
        <div class="attribution">
          
            
            
              <img src="/assets/avatar-matt_raible-9974af6192eb1753b7137c8fff0a2c6e6bb9736a2517986cb5cc50bb040e83d4.jpg" alt="avatar-matt_raible.jpg" class="author-avatar">
            
            <address>Matt Raible</address>&nbsp;
            
              <a class="social_link" href="https://github.com/mraible"><i class="fa fa-github-square"></i></a>
            
            
              <a class="social_link" href="https://twitter.com/mraible"><i class="fa fa-twitter-square"></i></a>
            
            
            
              <a class="social_link" href="http://raibledesigns.com"><i class="fa fa-external-link-square"></i></a>
            
            <span class="sepr">&middot;</span>
          
          <time datetime="2017-04-17">April 17, 2017</time>
	      </div>
	    </header>
	    <section class="post-content">
	     <p>Angular (formerly called Angular 2.0) is quickly becoming one of the most powerful ways to build a modern single-page app. A core strength is Angular’s focus on building reusable components, which help you decouple the various concerns in your application. Take authentication, for example: it can be painful to build, but once you wrap it in a component, the authentication logic can be reused throughout your application.</p>

<p>The Angular CLI makes it easy to scaffold new components, and even entire projects. If you haven’t used the Angular CLI to quickly generate Angular code, you’re in for a treat!</p>

<p>In this example, you’ll build a simple web application with Angular CLI, a tool for Angular development. You’ll create an application with search and edit features, then add authentication.</p>

<h2 id="create-an-angular-application">Create an Angular Application</h2>

<p><em>TIP: If you’d like to skip building the Angular application and get right to adding authentication, you can clone my <code class="highlighter-rouge">ng-demo</code> project, then skip to the <a href="#create-open-id-connect-app">Create an OpenID Connect App in Okta</a> section.</em></p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>git clone https://github.com/mraible/ng-demo.git
</code></pre>
</div>

<h3 id="what-youll-need">What You’ll Need</h3>

<ul>
  <li>About 20 minutes</li>
  <li>A favorite text editor or IDE. I recommend <a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a></li>
  <li><a href="https://nodejs.org">Node.js</a> and npm installed. I recommend using <a href="https://github.com/creationix/nvm">nvm</a></li>
  <li><a href="https://cli.angular.io/">Angular CLI</a> installed. If you don’t have Angular CLI installed, install it using <code class="highlighter-rouge">npm install -g @angular/cli</code></li>
</ul>

<p>Create a new project using the <code class="highlighter-rouge">ng new</code> command:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>ng new ng-demo
</code></pre>
</div>

<p>This will create a <code class="highlighter-rouge">ng-demo</code> project and run <code class="highlighter-rouge">npm install</code> in it. It should take about a minute to complete, but that could vary depending on your connection speed.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>mraible:~/dev] <span class="nv">$ </span>ng new ng-demo
installing ng
  create .editorconfig
  create README.md
  create src/app/app.component.css
  create src/app/app.component.html
  create src/app/app.component.spec.ts
  create src/app/app.component.ts
  create src/app/app.module.ts
  create src/assets/.gitkeep
  create src/environments/environment.prod.ts
  create src/environments/environment.ts
  create src/favicon.ico
  create src/index.html
  create src/main.ts
  create src/polyfills.ts
  create src/styles.css
  create src/test.ts
  create src/tsconfig.app.json
  create src/tsconfig.spec.json
  create src/typings.d.ts
  create .angular-cli.json
  create e2e/app.e2e-spec.ts
  create e2e/app.po.ts
  create e2e/tsconfig.e2e.json
  create .gitignore
  create karma.conf.js
  create package.json
  create protractor.conf.js
  create tsconfig.json
  create tslint.json
Successfully initialized git.
Installing packages <span class="k">for </span>tooling via npm.
Installed packages <span class="k">for </span>tooling via npm.
You can <span class="sb">`</span>ng <span class="nb">set</span> --global <span class="nv">packageManager</span><span class="o">=</span>yarn<span class="sb">`</span>.
Project <span class="s1">'ng-demo'</span> successfully created.
<span class="o">[</span>mraible:~] 46s <span class="err">$</span>
</code></pre>
</div>

<p>You can see the what version of Angular CLI you’re using with <code class="highlighter-rouge">ng --version</code>.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ng --version
    _                      _                 ____ _     ___
   / <span class="se">\ </span>  _ __   __ _ _   _| | __ _ _ __     / ___| |   |_ _|
  / △ <span class="se">\ </span>| <span class="s1">'_ \ / _` | | | | |/ _` | '</span>__|   | |   | |    | |
 / ___ <span class="se">\|</span> | | | <span class="o">(</span>_| | |_| | | <span class="o">(</span>_| | |      | |___| |___ | |
/_/   <span class="se">\_\_</span>| |_|<span class="se">\_</span>_, |<span class="se">\_</span>_,_|_|<span class="se">\_</span>_,_|_|       <span class="se">\_</span>___|_____|___|
               |___/
@angular/cli: 1.0.0
node: 6.9.5
os: darwin x64
</code></pre>
</div>

<h2 id="run-your-angular-application">Run Your Angular Application</h2>

<p>The project is configured with <a href="https://webpack.github.io/docs/webpack-dev-server.html">webpack dev server</a>. To start it, make sure you’re in the <code class="highlighter-rouge">ng-demo</code> directory, then run:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>ng serve
</code></pre>
</div>

<p>You should see a screen like the one below at <a href="http://localhost:4200">http://localhost:4200</a>.</p>

<p><img src="/assets/blog/angular-oidc/default-homepage-21ec1ed2afebe3a7e384626a8019479e61b079a939f1c3ed9317e3d7be3331c0.png" alt="Default Homepage" width="800" /></p>

<p>You can make sure your new project’s tests pass, run <code class="highlighter-rouge">ng test</code>:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ng <span class="nb">test</span>
...
Chrome 56.0.2924 <span class="o">(</span>Mac OS X 10.12.2<span class="o">)</span>: Executed 3 of 3 SUCCESS <span class="o">(</span>0.377 secs / 0.341 secs<span class="o">)</span>
</code></pre>
</div>

<h2 id="add-a-search-feature">Add a Search Feature</h2>

<p>To add a search feature, open the project in an IDE or your favorite text editor. For IntelliJ IDEA, use File &gt; New Project &gt; Static Web and point to the <code class="highlighter-rouge">ng-demo</code> directory.</p>

<p>In a terminal window, cd into your project’s directory and run the following command. This will create a search component.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ng g component search
installing component
  create src/app/search/search.component.css
  create src/app/search/search.component.html
  create src/app/search/search.component.spec.ts
  create src/app/search/search.component.ts
  update src/app/app.module.ts
</code></pre>
</div>

<p>Open <code class="highlighter-rouge">src/app/search/search.component.html</code> and replace its default HTML with the following:</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;h2&gt;</span>Search<span class="nt">&lt;/h2&gt;</span>
<span class="nt">&lt;form&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">name=</span><span class="s">"query"</span> <span class="err">[(</span><span class="na">ngModel</span><span class="err">)]="</span><span class="na">query</span><span class="err">"</span> <span class="err">(</span><span class="na">keyup</span><span class="err">.</span><span class="na">enter</span><span class="err">)="</span><span class="na">search</span><span class="err">()"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span> <span class="err">(</span><span class="na">click</span><span class="err">)="</span><span class="na">search</span><span class="err">()"</span><span class="nt">&gt;</span>Search<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;pre&gt;</span>{{searchResults | json}}<span class="nt">&lt;/pre&gt;</span>
</code></pre>
</div>

<p>The <a href="https://angular.io/docs/ts/latest/guide/router.html">Router documentation</a> for Angular provides the information you need to setup a route to the <code class="highlighter-rouge">SearchComponent</code> you just generated. Here’s a quick summary:</p>

<p>In <code class="highlighter-rouge">src/app/app.module.ts</code>, add an <code class="highlighter-rouge">appRoutes</code> constant and import it in <code class="highlighter-rouge">@NgModule</code>:</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Routes</span><span class="p">,</span> <span class="nx">RouterModule</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/router'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">appRoutes</span><span class="err">:</span> <span class="nx">Routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'search'</span><span class="p">,</span> <span class="na">component</span><span class="p">:</span> <span class="nx">SearchComponent</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">redirectTo</span><span class="p">:</span> <span class="s1">'/search'</span><span class="p">,</span> <span class="na">pathMatch</span><span class="p">:</span> <span class="s1">'full'</span> <span class="p">}</span>
<span class="p">];</span>

<span class="err">@</span><span class="nx">NgModule</span><span class="p">({</span>
  <span class="p">...</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">...</span>
    <span class="nx">RouterModule</span><span class="p">.</span><span class="nx">forRoot</span><span class="p">(</span><span class="nx">appRoutes</span><span class="p">)</span>
  <span class="p">]</span>
  <span class="p">...</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="p">{</span> <span class="p">}</span>
</code></pre>
</div>

<p>In <code class="highlighter-rouge">src/app/app.component.html</code>, add a <code class="highlighter-rouge">RouterOutlet</code> to display routes.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;router-outlet&gt;&lt;/router-outlet&gt;</span>
</code></pre>
</div>

<p>Now that you have routing setup, you can continue writing the search feature.</p>

<p>If you still have <code class="highlighter-rouge">ng serve</code> running, your browser should refresh automatically. If not, navigate to <a href="http://localhost:4200">http://localhost:4200</a>, and you should see the search form.</p>

<p><img src="/assets/blog/angular-oidc/search-without-css-664524fe9f5061f8c27851eace27912fa88caa8f999f06b8840ac1b2e21965a2.png" alt="Search component" width="800" /></p>

<p>If you want to add CSS for this components, open <code class="highlighter-rouge">src/app/search/search.component.css</code> and add some CSS. For example:</p>

<div class="language-css highlighter-rouge"><pre class="highlight"><code><span class="nd">:host</span> <span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">0</span> <span class="m">20px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>This section has shown you how to generate a new component to a basic Angular application with Angular CLI. The next section will show you how to create a use a JSON file and <code class="highlighter-rouge">localStorage</code> to create a fake API.</p>

<p>To get search results, create a <code class="highlighter-rouge">SearchService</code> that makes HTTP requests to a JSON file. Start by generating a new service.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ng g service search
installing service
  create src/app/search.service.spec.ts
  create src/app/search.service.ts
  WARNING Service is generated but not provided, it must be provided to be used
</code></pre>
</div>

<p>Move the generated <code class="highlighter-rouge">search.service.ts</code> and its test to <code class="highlighter-rouge">app/shared/search</code>. You’ll need to create this directory. Create <code class="highlighter-rouge">src/assets/data/people.json</code> to hold your data.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Peyton Manning"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(303) 567-8910"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234 Main Street"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Greenwood Village"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CO"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"zip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"80111"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Demaryius Thomas"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(720) 213-9876"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5555 Marion Street"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Denver"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CO"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"zip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"80202"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Von Miller"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(917) 323-2333"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14 Mountain Way"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Vail"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CO"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"zip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"81657"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
</div>

<p>Modify <code class="highlighter-rouge">src/app/shared/search/search.service.ts</code> and provide <code class="highlighter-rouge">Http</code> as a dependency in its constructor. In this same file, create a <code class="highlighter-rouge">getAll()</code> method to gather all the people. Also, define the <code class="highlighter-rouge">Address</code> and <code class="highlighter-rouge">Person</code> classes that JSON will be marshalled to.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Injectable</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Http</span><span class="p">,</span> <span class="nx">Response</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/http'</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">'rxjs/add/operator/map'</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kr">class</span> <span class="nx">SearchService</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">http</span><span class="err">:</span> <span class="nx">Http</span><span class="p">)</span> <span class="p">{}</span>

  <span class="nx">getAll</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'assets/data/people.json'</span><span class="p">).</span><span class="nx">map</span><span class="p">((</span><span class="nx">res</span><span class="err">:</span> <span class="nx">Response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">class</span> <span class="nx">Address</span> <span class="p">{</span>
  <span class="nl">street</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">city</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">state</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">zip</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="nx">obj</span><span class="p">?:</span> <span class="kr">any</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">street</span> <span class="o">=</span> <span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">street</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">city</span> <span class="o">=</span> <span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">city</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">state</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">zip</span> <span class="o">=</span> <span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">zip</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">class</span> <span class="nx">Person</span> <span class="p">{</span>
  <span class="nl">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">phone</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">address</span><span class="p">:</span> <span class="nx">Address</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="nx">obj</span><span class="p">?:</span> <span class="kr">any</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">name</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">phone</span> <span class="o">=</span> <span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">phone</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">address</span> <span class="o">=</span> <span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">address</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>To make these classes available for consumption by your components, edit <code class="highlighter-rouge">src/app/shared/index.ts</code> and add the following:</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">export</span> <span class="o">*</span> <span class="k">from</span> <span class="s1">'./search/search.service'</span><span class="p">;</span>
</code></pre>
</div>

<p>The reason for creating this file is so you can import multiple classes on a single line rather than having to import each individual class on separate lines.</p>

<p>In <code class="highlighter-rouge">search.component.ts</code>, add imports for these classes.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Person</span><span class="p">,</span> <span class="nx">SearchService</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'../shared'</span><span class="p">;</span>
</code></pre>
</div>

<p>You can now add <code class="highlighter-rouge">query</code> and <code class="highlighter-rouge">searchResults</code> variables. While you’re there, modify the constructor to inject the <code class="highlighter-rouge">SearchService</code>.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">export</span> <span class="kr">class</span> <span class="nx">SearchComponent</span> <span class="k">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>
  <span class="nl">query</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">searchResults</span><span class="p">:</span> <span class="nb">Array</span><span class="o">&lt;</span><span class="nx">Person</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">searchService</span><span class="err">:</span> <span class="nx">SearchService</span><span class="p">)</span> <span class="p">{}</span>
</code></pre>
</div>

<p>Then implement a <code class="highlighter-rouge">search()</code> method to call the service’s <code class="highlighter-rouge">getAll()</code> method.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="nx">search</span><span class="p">()</span><span class="err">:</span> <span class="k">void</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">searchService</span><span class="p">.</span><span class="nx">getAll</span><span class="p">().</span><span class="nx">subscribe</span><span class="p">(</span>
    <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">searchResults</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span> <span class="p">},</span>
    <span class="nx">error</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span>
  <span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>

<p>At this point, you’ll likely see the following message in your browser’s console.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>ORIGINAL EXCEPTION: No provider for SearchService!
</code></pre>
</div>

<p>To fix the “No provider” error from above, update <code class="highlighter-rouge">app.component.ts</code> to import the <code class="highlighter-rouge">SearchService</code>
and add the service to the list of providers.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">SearchService</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./shared'</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="p">...</span>
  <span class="na">styleUrls</span><span class="p">:</span> <span class="p">[</span><span class="s1">'./app.component.css'</span><span class="p">],</span>
  <span class="na">viewProviders</span><span class="p">:</span> <span class="p">[</span><span class="nx">SearchService</span><span class="p">]</span>
<span class="p">})</span>
</code></pre>
</div>

<p>Now clicking the search button should work. To make the results look better, remove the <code class="highlighter-rouge">&lt;pre&gt;</code> tag and replace it with a <code class="highlighter-rouge">&lt;table&gt;</code> in <code class="highlighter-rouge">src/app/search/search.component.html</code>.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;table</span> <span class="err">*</span><span class="na">ngIf=</span><span class="s">"searchResults"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;thead&gt;</span>
  <span class="nt">&lt;tr&gt;</span>
    <span class="nt">&lt;th&gt;</span>Name<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;th&gt;</span>Phone<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;th&gt;</span>Address<span class="nt">&lt;/th&gt;</span>
  <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/thead&gt;</span>
  <span class="nt">&lt;tbody&gt;</span>
  <span class="nt">&lt;tr</span> <span class="err">*</span><span class="na">ngFor=</span><span class="s">"let person of searchResults; let i=index"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;td&gt;</span>{{person.name}}<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span>{{person.phone}}<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span>{{person.address.street}}<span class="nt">&lt;br/&gt;</span>
      {{person.address.city}}, {{person.address.state}} {{person.address.zip}}
    <span class="nt">&lt;/td&gt;</span>
  <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</code></pre>
</div>

<p>Then add some additional CSS in <code class="highlighter-rouge">src/app/search/search.component.css</code> to improve its table layout.</p>

<div class="language-css highlighter-rouge"><pre class="highlight"><code><span class="nt">table</span> <span class="p">{</span>
  <span class="nl">margin-top</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
  <span class="nl">border-collapse</span><span class="p">:</span> <span class="nb">collapse</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">th</span> <span class="p">{</span>
  <span class="nl">text-align</span><span class="p">:</span> <span class="nb">left</span><span class="p">;</span>
  <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">2px</span> <span class="nb">solid</span> <span class="m">#ddd</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">8px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">td</span> <span class="p">{</span>
  <span class="nl">border-top</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#ddd</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">8px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Now the search results look better.</p>

<p><img src="/assets/blog/angular-oidc/search-results-5564a373ca4b9e85d624289b73d10a486e9ac214ce23d09929fb0dfa42365856.png" alt="Search Results" width="800" /></p>

<p>But wait, you still don’t have search functionality! To add a search feature, add a <code class="highlighter-rouge">search()</code> method to <code class="highlighter-rouge">SearchService</code>.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Observable</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'rxjs'</span><span class="p">;</span>

<span class="nx">search</span><span class="p">(</span><span class="nx">q</span><span class="err">:</span> <span class="kr">string</span><span class="p">)</span><span class="err">:</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="kr">any</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">q</span> <span class="o">||</span> <span class="nx">q</span> <span class="o">===</span> <span class="s1">'*'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">q</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">q</span> <span class="o">=</span> <span class="nx">q</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">getAll</span><span class="p">().</span><span class="nx">map</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">item</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">q</span><span class="p">)));</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Then refactor <code class="highlighter-rouge">SearchComponent</code> to call this method with its <code class="highlighter-rouge">query</code> variable.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="nx">search</span><span class="p">()</span><span class="err">:</span> <span class="k">void</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">searchService</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">query</span><span class="p">).</span><span class="nx">subscribe</span><span class="p">(</span>
    <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">searchResults</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span> <span class="p">},</span>
    <span class="nx">error</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span>
  <span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Now search results will be filtered by the query value you type in.</p>

<p>This section showed you how to fetch and display search results. The next section builds on this and shows how to edit and save a record.</p>

<h2 id="add-an-edit-feature">Add an Edit Feature</h2>

<p>Modify <code class="highlighter-rouge">search.component.html</code> to add a link for editing a person.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;td&gt;&lt;a</span> <span class="err">[</span><span class="na">routerLink</span><span class="err">]="['/</span><span class="na">edit</span><span class="err">',</span> <span class="na">person</span><span class="err">.</span><span class="na">id</span><span class="err">]"</span><span class="nt">&gt;</span>{{person.name}}<span class="nt">&lt;/a&gt;&lt;/td&gt;</span>
</code></pre>
</div>

<p>Run the following command to generate an <code class="highlighter-rouge">EditComponent</code>.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ng g component edit
installing component
  create src/app/edit/edit.component.css
  create src/app/edit/edit.component.html
  create src/app/edit/edit.component.spec.ts
  create src/app/edit/edit.component.ts
  update src/app/app.module.ts
</code></pre>
</div>

<p>Add a route for this component in <code class="highlighter-rouge">app.module.ts</code>:</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">appRoutes</span><span class="err">:</span> <span class="nx">Routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'search'</span><span class="p">,</span> <span class="na">component</span><span class="p">:</span> <span class="nx">SearchComponent</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'edit/:id'</span><span class="p">,</span> <span class="na">component</span><span class="p">:</span> <span class="nx">EditComponent</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">redirectTo</span><span class="p">:</span> <span class="s1">'/search'</span><span class="p">,</span> <span class="na">pathMatch</span><span class="p">:</span> <span class="s1">'full'</span> <span class="p">}</span>
<span class="p">];</span>
</code></pre>
</div>

<p>Update <code class="highlighter-rouge">src/app/edit/edit.component.html</code> to display an editable form. You might notice I’ve added <code class="highlighter-rouge">id</code> attributes to most elements. This is to make things easier when writing integration tests with Protractor.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="err">*</span><span class="na">ngIf=</span><span class="s">"person"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h3&gt;</span>{{editName}}<span class="nt">&lt;/h3&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;label&gt;</span>Id:<span class="nt">&lt;/label&gt;</span>
    {{person.id}}
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;label&gt;</span>Name:<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="err">[(</span><span class="na">ngModel</span><span class="err">)]="</span><span class="na">editName</span><span class="err">"</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">id=</span><span class="s">"name"</span> <span class="na">placeholder=</span><span class="s">"name"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;label&gt;</span>Phone:<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="err">[(</span><span class="na">ngModel</span><span class="err">)]="</span><span class="na">editPhone</span><span class="err">"</span> <span class="na">name=</span><span class="s">"phone"</span> <span class="na">id=</span><span class="s">"phone"</span> <span class="na">placeholder=</span><span class="s">"Phone"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;fieldset&gt;</span>
    <span class="nt">&lt;legend&gt;</span>Address:<span class="nt">&lt;/legend&gt;</span>
    <span class="nt">&lt;address&gt;</span>
      <span class="nt">&lt;input</span> <span class="err">[(</span><span class="na">ngModel</span><span class="err">)]="</span><span class="na">editAddress</span><span class="err">.</span><span class="na">street</span><span class="err">"</span> <span class="na">id=</span><span class="s">"street"</span><span class="nt">&gt;&lt;br/&gt;</span>
      <span class="nt">&lt;input</span> <span class="err">[(</span><span class="na">ngModel</span><span class="err">)]="</span><span class="na">editAddress</span><span class="err">.</span><span class="na">city</span><span class="err">"</span> <span class="na">id=</span><span class="s">"city"</span><span class="nt">&gt;</span>,
      <span class="nt">&lt;input</span> <span class="err">[(</span><span class="na">ngModel</span><span class="err">)]="</span><span class="na">editAddress</span><span class="err">.</span><span class="na">state</span><span class="err">"</span> <span class="na">id=</span><span class="s">"state"</span> <span class="na">size=</span><span class="s">"2"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="err">[(</span><span class="na">ngModel</span><span class="err">)]="</span><span class="na">editAddress</span><span class="err">.</span><span class="na">zip</span><span class="err">"</span> <span class="na">id=</span><span class="s">"zip"</span> <span class="na">size=</span><span class="s">"5"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/address&gt;</span>
  <span class="nt">&lt;/fieldset&gt;</span>
  <span class="nt">&lt;button</span> <span class="err">(</span><span class="na">click</span><span class="err">)="</span><span class="na">save</span><span class="err">()"</span> <span class="na">id=</span><span class="s">"save"</span><span class="nt">&gt;</span>Save<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;button</span> <span class="err">(</span><span class="na">click</span><span class="err">)="</span><span class="na">cancel</span><span class="err">()"</span> <span class="na">id=</span><span class="s">"cancel"</span><span class="nt">&gt;</span>Cancel<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre>
</div>

<p>Modify <code class="highlighter-rouge">EditComponent</code> to import model and service classes and to use the <code class="highlighter-rouge">SearchService</code> to get data.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">OnInit</span><span class="p">,</span> <span class="nx">OnDestroy</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Address</span><span class="p">,</span> <span class="nx">Person</span><span class="p">,</span> <span class="nx">SearchService</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'../shared'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Subscription</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'rxjs'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ActivatedRoute</span><span class="p">,</span> <span class="nx">Router</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/router'</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="s1">'app-edit'</span><span class="p">,</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'./edit.component.html'</span><span class="p">,</span>
  <span class="na">styleUrls</span><span class="p">:</span> <span class="p">[</span><span class="s1">'./edit.component.css'</span><span class="p">]</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kr">class</span> <span class="nx">EditComponent</span> <span class="k">implements</span> <span class="nx">OnInit</span><span class="p">,</span> <span class="nx">OnDestroy</span> <span class="p">{</span>
  <span class="nl">person</span><span class="p">:</span> <span class="nx">Person</span><span class="p">;</span>
  <span class="nl">editName</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">editPhone</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">editAddress</span><span class="p">:</span> <span class="nx">Address</span><span class="p">;</span>

  <span class="nl">sub</span><span class="p">:</span> <span class="nx">Subscription</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">route</span><span class="err">:</span> <span class="nx">ActivatedRoute</span><span class="p">,</span>
              <span class="k">private</span> <span class="nx">router</span><span class="err">:</span> <span class="nx">Router</span><span class="p">,</span>
              <span class="k">private</span> <span class="nx">service</span><span class="err">:</span> <span class="nx">SearchService</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nx">ngOnInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">sub</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">params</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">id</span> <span class="o">=</span> <span class="o">+</span> <span class="nx">params</span><span class="p">[</span><span class="s1">'id'</span><span class="p">];</span> <span class="c1">// (+) converts string 'id' to a number</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">service</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">id</span><span class="p">).</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">person</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">person</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">editName</span> <span class="o">=</span> <span class="nx">person</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">editPhone</span> <span class="o">=</span> <span class="nx">person</span><span class="p">.</span><span class="nx">phone</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">editAddress</span> <span class="o">=</span> <span class="nx">person</span><span class="p">.</span><span class="nx">address</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">person</span> <span class="o">=</span> <span class="nx">person</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">gotoList</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="nx">ngOnDestroy</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">sub</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">cancel</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span><span class="p">([</span><span class="s1">'/search'</span><span class="p">]);</span>
  <span class="p">}</span>

  <span class="nx">save</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">editName</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">phone</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">editPhone</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">address</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">editAddress</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">service</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">person</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gotoList</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">gotoList</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">person</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span><span class="p">([</span><span class="s1">'/search'</span><span class="p">,</span> <span class="p">{</span><span class="na">term</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span> <span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span><span class="p">([</span><span class="s1">'/search'</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Modify <code class="highlighter-rouge">SearchService</code> to contain functions for finding a person by their id, and saving them. While you’re in there, modify the <code class="highlighter-rouge">search()</code> method to be aware of updated objects in <code class="highlighter-rouge">localStorage</code>.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="nx">search</span><span class="p">(</span><span class="nx">q</span><span class="err">:</span> <span class="kr">string</span><span class="p">)</span><span class="err">:</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="kr">any</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">q</span> <span class="o">||</span> <span class="nx">q</span> <span class="o">===</span> <span class="s1">'*'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">q</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">q</span> <span class="o">=</span> <span class="nx">q</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">getAll</span><span class="p">().</span><span class="nx">map</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="na">results</span><span class="p">:</span> <span class="kr">any</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="c1">// check for item in localStorage</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">localStorage</span><span class="p">[</span><span class="s1">'person'</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">])</span> <span class="p">{</span>
        <span class="nx">item</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">localStorage</span><span class="p">[</span><span class="s1">'person'</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">]);</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">item</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">q</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="nx">get</span><span class="p">(</span><span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">getAll</span><span class="p">().</span><span class="nx">map</span><span class="p">(</span><span class="nx">all</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">localStorage</span><span class="p">[</span><span class="s1">'person'</span> <span class="o">+</span> <span class="nx">id</span><span class="p">])</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">localStorage</span><span class="p">[</span><span class="s1">'person'</span> <span class="o">+</span> <span class="nx">id</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">all</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="nx">save</span><span class="p">(</span><span class="na">person</span><span class="p">:</span> <span class="nx">Person</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">localStorage</span><span class="p">[</span><span class="s1">'person'</span> <span class="o">+</span> <span class="nx">person</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">person</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You can add CSS to <code class="highlighter-rouge">src/app/edit/edit.component.css</code> if you want to make the form look a bit better.</p>

<div class="language-css highlighter-rouge"><pre class="highlight"><code><span class="nd">:host</span> <span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">0</span> <span class="m">20px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">button</span> <span class="p">{</span>
  <span class="nl">margin-top</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>At this point, you should be able to search for a person and update their information.</p>

<p><img src="/assets/blog/angular-oidc/edit-form-9e8118d51384c2d0f5e20f464da2bad40278f750311e2f002de265cf403edcb9.png" alt="Edit form" width="800" /></p>

<p>The <code class="highlighter-rouge">&lt;form&gt;</code> in <code class="highlighter-rouge">src/app/edit/edit.component.html</code> calls a <code class="highlighter-rouge">save()</code> function to update a person’s data. You already implemented this above.
The function calls a <code class="highlighter-rouge">gotoList()</code> function that appends the person’s name to the URL when sending the user back to the search screen.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="nx">gotoList</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">person</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span><span class="p">([</span><span class="s1">'/search'</span><span class="p">,</span> <span class="p">{</span><span class="na">term</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span> <span class="p">]);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span><span class="p">([</span><span class="s1">'/search'</span><span class="p">]);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Since the <code class="highlighter-rouge">SearchComponent</code> doesn’t execute a search automatically when you execute this URL, add the following logic to do so in its constructor.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Router</span><span class="p">,</span> <span class="nx">ActivatedRoute</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/router'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Subscription</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'rxjs'</span><span class="p">;</span>
<span class="p">...</span>
  <span class="nl">sub</span><span class="p">:</span> <span class="nx">Subscription</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">searchService</span><span class="err">:</span> <span class="nx">SearchService</span><span class="p">,</span> <span class="k">private</span> <span class="nx">router</span><span class="err">:</span> <span class="nx">Router</span><span class="p">,</span> <span class="k">private</span> <span class="nx">route</span><span class="err">:</span> <span class="nx">ActivatedRoute</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">sub</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">params</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">params</span><span class="p">[</span><span class="s1">'term'</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">query</span> <span class="o">=</span> <span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">params</span><span class="p">[</span><span class="s1">'term'</span><span class="p">]);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">search</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>
</code></pre>
</div>

<p>You’ll want to implement <code class="highlighter-rouge">OnDestroy</code> and define the <code class="highlighter-rouge">ngOnDestroy</code> method to clean up this subscription.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">OnInit</span><span class="p">,</span> <span class="nx">OnDestroy</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>

<span class="k">export</span> <span class="kr">class</span> <span class="nx">SearchComponent</span> <span class="k">implements</span> <span class="nx">OnInit</span><span class="p">,</span> <span class="nx">OnDestroy</span> <span class="p">{</span>
<span class="p">...</span>
  <span class="nx">ngOnDestroy</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">sub</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>After making all these changes, you should be able to search/edit/update a person’s information. If it works - nice job!</p>

<h3 id="form-validation">Form Validation</h3>

<p>One thing you might notice is you can clear any input element in the form and save it. At the very least, the <code class="highlighter-rouge">name</code> field should be required. Otherwise, there’s nothing to click on in the search results.</p>

<p>To make name required, modify <code class="highlighter-rouge">edit.component.html</code> to add a <code class="highlighter-rouge">required</code> attribute to the name <code class="highlighter-rouge">&lt;input&gt;</code>.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="err">[(</span><span class="na">ngModel</span><span class="err">)]="</span><span class="na">editName</span><span class="err">"</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">id=</span><span class="s">"name"</span> <span class="na">placeholder=</span><span class="s">"name"</span> <span class="na">required</span><span class="nt">/&gt;</span>
</code></pre>
</div>

<p>You’ll also need to wrap everything in a <code class="highlighter-rouge">&lt;form&gt;</code> element. Add <code class="highlighter-rouge">&lt;form&gt;</code> after the <code class="highlighter-rouge">&lt;h3&gt;</code> tag and close it before the last <code class="highlighter-rouge">&lt;/div&gt;</code>. You’ll also need to add an <code class="highlighter-rouge">(ngSubmit)</code> handler to the form and change the save button to be a regular submit button.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;h3&gt;</span>{{editName}}<span class="nt">&lt;/h3&gt;</span>
<span class="nt">&lt;form</span> <span class="err">(</span><span class="na">ngSubmit</span><span class="err">)="</span><span class="na">save</span><span class="err">()"</span> <span class="na">ngNativeValidate</span><span class="nt">&gt;</span>
  ...
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">id=</span><span class="s">"save"</span><span class="nt">&gt;</span>Save<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;button</span> <span class="err">(</span><span class="na">click</span><span class="err">)="</span><span class="na">cancel</span><span class="err">()"</span> <span class="na">id=</span><span class="s">"cancel"</span><span class="nt">&gt;</span>Cancel<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
</div>

<p>After making these changes, any field with a <code class="highlighter-rouge">required</code> attribute will be required.</p>

<p><img src="/assets/blog/angular-oidc/edit-form-validation-8fa28d60c24ace53ee83db37b94d719a9d8c6772d99a07131d43b6bc063b5774.png" alt="Edit form with validation" width="800" /></p>

<p>In this screenshot, you might notice the address fields are blank. This is explained by the error in your console.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>If ngModel is used within a form tag, either the name attribute must be set or the form
control must be defined as 'standalone' in ngModelOptions.

Example 1: &lt;input [(ngModel)]="person.firstName" name="first"&gt;
Example 2: &lt;input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}"&gt;
</code></pre>
</div>

<p>To fix, add a <code class="highlighter-rouge">name</code> attribute to all the address fields. For example:</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;address&gt;</span>
  <span class="nt">&lt;input</span> <span class="err">[(</span><span class="na">ngModel</span><span class="err">)]="</span><span class="na">editAddress</span><span class="err">.</span><span class="na">street</span><span class="err">"</span> <span class="na">name=</span><span class="s">"street"</span> <span class="na">id=</span><span class="s">"street"</span><span class="nt">&gt;&lt;br/&gt;</span>
  <span class="nt">&lt;input</span> <span class="err">[(</span><span class="na">ngModel</span><span class="err">)]="</span><span class="na">editAddress</span><span class="err">.</span><span class="na">city</span><span class="err">"</span> <span class="na">name=</span><span class="s">"city"</span> <span class="na">id=</span><span class="s">"city"</span><span class="nt">&gt;</span>,
  <span class="nt">&lt;input</span> <span class="err">[(</span><span class="na">ngModel</span><span class="err">)]="</span><span class="na">editAddress</span><span class="err">.</span><span class="na">state</span><span class="err">"</span> <span class="na">name=</span><span class="s">"state"</span> <span class="na">id=</span><span class="s">"state"</span> <span class="na">size=</span><span class="s">"2"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="err">[(</span><span class="na">ngModel</span><span class="err">)]="</span><span class="na">editAddress</span><span class="err">.</span><span class="na">zip</span><span class="err">"</span> <span class="na">name=</span><span class="s">"zip"</span> <span class="na">id=</span><span class="s">"zip"</span> <span class="na">size=</span><span class="s">"5"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/address&gt;</span>
</code></pre>
</div>

<p>Now values should display in all fields and <code class="highlighter-rouge">name</code> should be required.</p>

<p><img src="/assets/blog/angular-oidc/edit-form-names-bf02d6ef39bff4a672ff4323df488fa0be1d10e889a1d5dc0e8cba4b5ec74b05.png" alt="Edit form with names and validation" width="800" /></p>

<p>With Angular 2, this is all you’ll need to do. However, with Angular 4+, you need to a little more work to stop the form from submitting.</p>

<ul>
  <li>To display HTML5 validation messages, add the <code class="highlighter-rouge">ngNativeValidate</code> directive to the <code class="highlighter-rouge">&lt;form&gt;</code> tag.</li>
  <li>If you want to provide your own validation messages:
    <ul>
      <li>Add <code class="highlighter-rouge">#editForm="ngForm"</code> to the <code class="highlighter-rouge">&lt;form&gt;</code> element.</li>
      <li>Add <code class="highlighter-rouge">#name="ngModel"</code> to the <code class="highlighter-rouge">&lt;input id="name"&gt;</code> element.</li>
      <li>Add <code class="highlighter-rouge">[disabled]="!editForm.form.valid"</code> to the <em>Save</em> button.</li>
      <li>
        <p>Add the following under the <code class="highlighter-rouge">name</code> field to display a validation error.</p>

        <div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="err">[</span><span class="na">hidden</span><span class="err">]="</span><span class="na">name</span><span class="err">.</span><span class="na">valid</span> <span class="err">||</span> <span class="na">name</span><span class="err">.</span><span class="na">pristine</span><span class="err">"</span> <span class="na">style=</span><span class="s">"color: red"</span><span class="nt">&gt;</span>
  Name is required
<span class="nt">&lt;/div&gt;</span>
</code></pre>
        </div>
      </li>
    </ul>
  </li>
</ul>

<p>To learn more about forms and validation, see <a href="https://angular.io/docs/ts/latest/guide/forms.html">Angular forms documentation</a>.</p>

<p><a name="create-open-id-connect-app"></a></p>
<h2 id="create-an-openid-connect-app-in-okta">Create an OpenID Connect App in Okta</h2>

<p>OpenID Connect (OIDC) is built on top of the OAuth 2.0 protocol. It allows clients to verify the identity of the user and, as well as to obtain their basic profile information. To learn more, see <a href="https://openid.net/connect/">https://openid.net/connect/</a>.</p>

<p>To integrate <a href="https://developer.okta.com">Okta</a> for user authentication, you’ll first need to <a href="https://www.okta.com/developer/signup/">register</a> and create an OIDC application.</p>

<p>Login to your Okta account, or <a href="https://www.okta.com/developer/signup/">create one</a> if you don’t have one. Navigate to <strong>Admin &gt; Add Applications</strong> and click on the <strong>Create New App</strong> button. Select <strong>Single Page App (SPA)</strong> for the Platform and <strong>OpenID Connect</strong> for the sign on method. Click the <strong>Create</strong> button and give your application a name. On the next screen, add <code class="highlighter-rouge">http://localhost:4200</code> as a Redirect URI and click <strong>Finish</strong>. You should see settings like the following.</p>

<p><img src="/assets/blog/angular-oidc/oidc-settings-ec21ae1ecd7a70f68b887fa6ecf3daeb4f8f82e2f80328a2009272ff8b2c1c02.png" alt="OIDC App Settings" width="800" /></p>

<p>Click on the <strong>People</strong> tab and the <strong>Assign to People</strong> button. Assign yourself as a user, or someone else that you know the credentials for.</p>

<p>Install <a href="https://github.com/manfredsteyer">Manfred Steyer’s</a> project to <a href="https://github.com/manfredsteyer/angular-oauth2-oidc">add OAuth 2 and OpenID Connect support</a> using npm.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>npm install --save angular-oauth2-oidc
</code></pre>
</div>

<p>Modify <code class="highlighter-rouge">app.component.ts</code> to import <code class="highlighter-rouge">OAuthService</code> and configure your app to use your Okta application settings.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">OAuthService</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'angular-oauth2-oidc'</span><span class="p">;</span>

<span class="p">...</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">oauthService</span><span class="err">:</span> <span class="nx">OAuthService</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">redirectUri</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">clientId</span> <span class="o">=</span> <span class="s1">'[client-id]'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">scope</span> <span class="o">=</span> <span class="s1">'openid profile email'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">oidc</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">issuer</span> <span class="o">=</span> <span class="s1">'https://dev-[dev-id].oktapreview.com'</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">loadDiscoveryDocument</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">tryLogin</span><span class="p">({});</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">...</span>
</code></pre>
</div>

<p>Create <code class="highlighter-rouge">src/app/home/home.component.ts</code> and configure it to have <strong>Login</strong> and <strong>Logout</strong> buttons.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">OAuthService</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'angular-oauth2-oidc'</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="na">template</span><span class="p">:</span> <span class="err">`</span><span class="o">&lt;</span><span class="nx">div</span> <span class="o">*</span><span class="nx">ngIf</span><span class="o">=</span><span class="s2">"givenName"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="p">,</span> <span class="p">{{</span><span class="nx">givenName</span><span class="p">}}</span><span class="o">!&lt;</span><span class="sr">/h2</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">button</span> <span class="p">(</span><span class="nx">click</span><span class="p">)</span><span class="o">=</span><span class="s2">"logout()"</span><span class="o">&gt;</span><span class="nx">Logout</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">routerLink</span><span class="o">=</span><span class="s2">"/search"</span> <span class="nx">routerLinkActive</span><span class="o">=</span><span class="s2">"active"</span><span class="o">&gt;</span><span class="nx">Search</span><span class="o">&lt;</span><span class="sr">/a&gt;&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="o">*</span><span class="nx">ngIf</span><span class="o">=</span><span class="s2">"!givenName"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">button</span> <span class="p">(</span><span class="nx">click</span><span class="p">)</span><span class="o">=</span><span class="s2">"login()"</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/div&gt;</span><span class="err">`
</span><span class="p">})</span>
<span class="k">export</span> <span class="kr">class</span> <span class="nx">HomeComponent</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="na">oauthService</span><span class="p">:</span> <span class="nx">OAuthService</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nx">login</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">initImplicitFlow</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">logout</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">logOut</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">get</span> <span class="nx">givenName</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">claims</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">getIdentityClaims</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">claims</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">claims</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Create <code class="highlighter-rouge">src/app/shared/auth/auth.guard.service.ts</code> to navigate to the <code class="highlighter-rouge">HomeComponent</code> if the user is not authenticated.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Injectable</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ActivatedRouteSnapshot</span><span class="p">,</span> <span class="nx">CanActivate</span><span class="p">,</span> <span class="nx">Router</span><span class="p">,</span> <span class="nx">RouterStateSnapshot</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/router'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">OAuthService</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'angular-oauth2-oidc'</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kr">class</span> <span class="nx">AuthGuard</span> <span class="k">implements</span> <span class="nx">CanActivate</span> <span class="p">{</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">oauthService</span><span class="err">:</span> <span class="nx">OAuthService</span><span class="p">,</span> <span class="k">private</span> <span class="nx">router</span><span class="err">:</span> <span class="nx">Router</span><span class="p">)</span> <span class="p">{}</span>

  <span class="nx">canActivate</span><span class="p">(</span><span class="nx">route</span><span class="err">:</span> <span class="nx">ActivatedRouteSnapshot</span><span class="p">,</span> <span class="nx">state</span><span class="err">:</span> <span class="nx">RouterStateSnapshot</span><span class="p">)</span><span class="err">:</span> <span class="kr">boolean</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">hasValidIdToken</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span><span class="p">([</span><span class="s1">'/home'</span><span class="p">]);</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Import the <code class="highlighter-rouge">OAuthModule</code> in <code class="highlighter-rouge">app.module.ts</code>, configure the new <code class="highlighter-rouge">HomeComponent</code>, and lock the <code class="highlighter-rouge">/search</code> and <code class="highlighter-rouge">/edit</code> routes down with the <code class="highlighter-rouge">AuthGuard</code>.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">OAuthModule</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'angular-oauth2-oidc'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">HomeComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./home/home.component'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AuthGuard</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./shared/auth/auth.guard.service'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">appRoutes</span><span class="err">:</span> <span class="nx">Routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'search'</span><span class="p">,</span> <span class="na">component</span><span class="p">:</span> <span class="nx">SearchComponent</span><span class="p">,</span> <span class="na">canActivate</span><span class="p">:</span> <span class="p">[</span><span class="nx">AuthGuard</span><span class="p">]</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'edit/:id'</span><span class="p">,</span> <span class="na">component</span><span class="p">:</span> <span class="nx">EditComponent</span><span class="p">,</span> <span class="na">canActivate</span><span class="p">:</span> <span class="p">[</span><span class="nx">AuthGuard</span><span class="p">]},</span>
  <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'home'</span><span class="p">,</span> <span class="na">component</span><span class="p">:</span> <span class="nx">HomeComponent</span><span class="p">},</span>
  <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="na">redirectTo</span><span class="p">:</span> <span class="s1">'home'</span><span class="p">,</span> <span class="na">pathMatch</span><span class="p">:</span> <span class="s1">'full'</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="s1">'**'</span><span class="p">,</span> <span class="na">redirectTo</span><span class="p">:</span> <span class="s1">'home'</span> <span class="p">}</span>
<span class="p">];</span>

<span class="err">@</span><span class="nx">NgModule</span><span class="p">({</span>
  <span class="na">declarations</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">...</span>
    <span class="nx">HomeComponent</span>
  <span class="p">],</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">...</span>
    <span class="nx">OAuthModule</span><span class="p">.</span><span class="nx">forRoot</span><span class="p">()</span>
  <span class="p">],</span>
  <span class="na">providers</span><span class="p">:</span> <span class="p">[</span><span class="nx">AuthGuard</span><span class="p">],</span>
  <span class="na">bootstrap</span><span class="p">:</span> <span class="p">[</span><span class="nx">AppComponent</span><span class="p">]</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="p">{</span> <span class="p">}</span>
</code></pre>
</div>

<p>After making these changes, you should be able to run <code class="highlighter-rouge">ng serve</code> and see a login button.</p>

<p><img src="/assets/blog/angular-oidc/okta-login-button-6945f18dd8e5eeb22be1d87785578f827769fc3ad2881b94a282a98c87db1363.png" alt="Login button" width="800" /></p>

<p>Click the <strong>Login</strong> button and sign-in with one of the people that’s configured in your Okta application.</p>

<p><img src="/assets/blog/angular-oidc/okta-login-form-12ee55c95cbbca0f863e611f9d876968e5d5298101ad7b453ef171b8725573fd.png" alt="Okta Login form" width="800" /></p>

<p>After logging in, you’ll be able to click <em>Search</em> and view people’s information.</p>

<p><img src="/assets/blog/angular-oidc/okta-post-login-638b4111e0d2fb1f04f9db2da3aa5857de970bf0b33c5b54e7854f5a0856c53f.png" alt="View after login" width="800" /></p>

<p>If it works - great! If you want to build your own login form in your app, continue reading to learn how to use the <a href="https://github.com/okta/okta-auth-js">Okta Auth SDK</a> with <code class="highlighter-rouge">OAuthService</code>.</p>

<h3 id="authentication-with-the-okta-auth-sdk">Authentication with the Okta Auth SDK</h3>

<p>The Okta Auth SDK builds on top of Otka’s <a href="/docs/api/resources/authn.html">Authentication API</a> and <a href="/docs/api/resources/oidc.html">OAuth 2.0 API</a> to enable you to create a fully branded sign-in experience using JavaScript.</p>

<p>Install it using npm:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>npm install @okta/okta-auth-js --save
</code></pre>
</div>

<p>Add a reference to this library’s main JavaScript file in <code class="highlighter-rouge">.angular-cli.json</code>:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="s2">"scripts"</span><span class="err">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="s2">"../node_modules/@okta/okta-auth-js/dist/okta-auth-js.min.js"</span><span class="w">
</span><span class="p">]</span><span class="err">,</span><span class="w">
</span></code></pre>
</div>

<p>The components in this section use Bootstrap CSS classes. Add a reference to Bootstrap’s CSS in the <code class="highlighter-rouge">&lt;head&gt;</code> of <code class="highlighter-rouge">src/index.html</code>.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;head&gt;</span>
  ...
  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>
</code></pre>
</div>

<p>Change <code class="highlighter-rouge">HomeComponent</code> to declare <code class="highlighter-rouge">OktaAuth</code> and modify its <code class="highlighter-rouge">template</code> so it has a button to login, as well as a sign-in form.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="kr">declare</span> <span class="kd">let</span> <span class="nx">OktaAuth</span><span class="err">:</span> <span class="kr">any</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="na">template</span><span class="p">:</span> <span class="err">`</span><span class="o">&lt;</span><span class="nx">div</span> <span class="o">*</span><span class="nx">ngIf</span><span class="o">=</span><span class="s2">"givenName"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="p">,</span> <span class="p">{{</span><span class="nx">givenName</span><span class="p">}}</span><span class="o">!&lt;</span><span class="sr">/h2</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">button</span> <span class="p">(</span><span class="nx">click</span><span class="p">)</span><span class="o">=</span><span class="s2">"logout()"</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"btn btn-default"</span><span class="o">&gt;</span><span class="nx">Logout</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">routerLink</span><span class="o">=</span><span class="s2">"/search"</span> <span class="nx">routerLinkActive</span><span class="o">=</span><span class="s2">"active"</span><span class="o">&gt;</span><span class="nx">Search</span><span class="o">&lt;</span><span class="sr">/a&gt;&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"panel panel-default"</span> <span class="o">*</span><span class="nx">ngIf</span><span class="o">=</span><span class="s2">"!givenName"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"panel-body"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Login</span> <span class="kd">with</span> <span class="nx">Authorization</span> <span class="nx">Server</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">button</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"btn btn-default"</span> <span class="p">(</span><span class="nx">click</span><span class="p">)</span><span class="o">=</span><span class="s2">"login()"</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"panel panel-default"</span> <span class="o">*</span><span class="nx">ngIf</span><span class="o">=</span><span class="s2">"!givenName"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"panel-body"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Login</span> <span class="kd">with</span> <span class="nx">Username</span><span class="o">/</span><span class="nx">Password</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>
        <span class="o">&lt;</span><span class="nx">p</span> <span class="nx">style</span><span class="o">=</span><span class="s2">"color:red; font-weight:bold"</span> <span class="o">*</span><span class="nx">ngIf</span><span class="o">=</span><span class="s2">"loginFailed"</span><span class="o">&gt;</span>
            <span class="nx">Login</span> <span class="nx">wasn</span><span class="err">'</span><span class="nx">t</span> <span class="nx">successful</span><span class="p">.</span>
        <span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"form-group"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span><span class="nx">Username</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">input</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="p">[(</span><span class="nx">ngModel</span><span class="p">)]</span><span class="o">=</span><span class="s2">"username"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"form-group"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span><span class="nx">Password</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">input</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="kd">type</span><span class="o">=</span><span class="s2">"password"</span> <span class="p">[(</span><span class="nx">ngModel</span><span class="p">)]</span><span class="o">=</span><span class="s2">"password"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"form-group"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">button</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"btn btn-default"</span> <span class="p">(</span><span class="nx">click</span><span class="p">)</span><span class="o">=</span><span class="s2">"loginWithPassword()"</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/div&gt;</span><span class="err">`
</span><span class="p">})</span>
</code></pre>
</div>

<p>After making these changes, the <code class="highlighter-rouge">HomeComponent</code> should render as follows.</p>

<p><img src="/assets/blog/angular-oidc/sign-in-form-e80bc5e512db14150307ec1395c35b8032288458363afb1acda6bcde3f08ccde.png" alt="Custom sign-in form" width="800" /></p>

<p>Import Angular’s <code class="highlighter-rouge">Router</code>, add it as a dependency in the constructor, and add local variables for the username and password fields. Then implement a <code class="highlighter-rouge">loginWithPassword()</code> method in <code class="highlighter-rouge">HomeComponent</code>. This method uses the <code class="highlighter-rouge">OktaAuth</code> library to get a session token and exchange it for ID and access tokens.</p>

<div class="language-typescript highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Router</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/router'</span><span class="p">;</span>
<span class="p">...</span>
<span class="k">export</span> <span class="kr">class</span> <span class="nx">HomeComponent</span> <span class="p">{</span>
  <span class="nx">username</span><span class="p">;</span>
  <span class="nx">password</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">oauthService</span><span class="err">:</span> <span class="nx">OAuthService</span><span class="p">,</span> <span class="k">private</span> <span class="nx">router</span><span class="err">:</span> <span class="nx">Router</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>
  <span class="p">...</span>
  <span class="nx">loginWithPassword</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">createAndSaveNonce</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">nonce</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">authClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OktaAuth</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="s1">'https://dev-158606.oktapreview.com'</span>
      <span class="p">});</span>
      <span class="nx">authClient</span><span class="p">.</span><span class="nx">signIn</span><span class="p">({</span>
        <span class="na">username</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span>
        <span class="na">password</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">password</span>
      <span class="p">}).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="s1">'SUCCESS'</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">authClient</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">getWithoutPrompt</span><span class="p">({</span>
            <span class="na">clientId</span><span class="p">:</span> <span class="s1">'RqjWvpvWO77qMGgDfukY'</span><span class="p">,</span>
            <span class="na">responseType</span><span class="p">:</span> <span class="p">[</span><span class="s1">'id_token'</span><span class="p">,</span> <span class="s1">'token'</span><span class="p">],</span>
            <span class="na">scopes</span><span class="p">:</span> <span class="p">[</span><span class="s1">'openid'</span><span class="p">,</span> <span class="s1">'profile'</span><span class="p">,</span> <span class="s1">'email'</span><span class="p">],</span>
            <span class="na">sessionToken</span><span class="p">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">sessionToken</span><span class="p">,</span>
            <span class="na">nonce</span><span class="p">:</span> <span class="nx">nonce</span><span class="p">,</span>
            <span class="na">redirectUri</span><span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span>
          <span class="p">})</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">tokens</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">processIdToken</span><span class="p">(</span><span class="nx">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">idToken</span><span class="p">,</span> <span class="nx">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">accessToken</span><span class="p">);</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span><span class="p">([</span><span class="s1">'/home'</span><span class="p">]);</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">'We cannot handle the '</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">+</span> <span class="s1">' status'</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}).</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You should be able to sign in using the form, using one of your app’s registered users. After logging in, you’ll be able to click the <strong>Search</strong> link and view people’s information.</p>

<p><img src="/assets/blog/angular-oidc/sign-in-form-success-4aab12fc46974aa46a57bfb1eb17da947d7c1b78bda68e18d04c0a5d8e3476cc.png" alt="View after sign-in" width="800" /></p>

<h2 id="angular--okta">Angular + Okta</h2>

<p>If everything works - congrats! If you encountered issues, please post a question to Stack Overflow with an <a href="http://stackoverflow.com/questions/tagged/okta">okta tag</a>, or hit me up on Twitter <a href="https://twitter.com/mraible">@mraible</a>.</p>

<p>You can find a completed version of the application created in this blog post <a href="https://github.com/oktadeveloper/okta-angular-openid-connect-example">on GitHub</a>. To learn more about security in Angular, see <a href="https://angular.io/docs/ts/latest/guide/security.html">Angular’s Security documentation</a>. If you’d like to learn more about OpenID Connect, I’d recommend watching the soothing video below.</p>

<div style="max-width: 560px; margin: 0 auto">
<iframe width="560" height="315" src="https://www.youtube.com/embed/Kb56GzQ2pSk" frameborder="0" allowfullscreen=""></iframe>
</div>


	    </section>
	  </article>
  </div>
</section>

	</div>
</section>

		
	</div><footer class="footer">
      <div class="Wrap">
        <ul>
          <li>
            <a href="https://www.okta.com" target="_blank">Okta.com</a>
          </li>
          <li>
            <a href="/blog/">Blog</a>
          </li>
          <li>
            <a href="/docs/platform-release-notes/platform-release-notes.html">Platform Release Notes</a>
          </li>
          <li>
            <a href="/terms/">Terms & Conditions</a>
          </li>
          <li>
            <a href="/3rd_party_notices/">3rd Party Notices</a>
          </li>
          <li>
            <a href="/privacy/">Privacy Policy</a>
          </li>
          <li>
            <a href="/contact/">Contact Sales</a>
          </li>
          <li>
            <a href="mailto:developers@okta.com">Contact Support</a>
          </li>
        </ul>
        <ul>
          <li>
            <a class="icon" href="http://github.com/oktadeveloper" target="_blank"><i class="fa fa-github"></i></a>
          </li>
          <li>
            <a class="icon" href="http://twitter.com/okta" target="_blank"><i class="fa fa-twitter"></i></a>
          </li>
          <li>
            <a class="icon" href="https://devforum.okta.com/" title="Okta Developer Forums" target="_blank"><i class="fa fa-comments"></i></a>
          </li>
          <li>
            <a class="icon" href="http://feeds.feedburner.com/OktaBlog" target="_blank"><i class="fa fa-rss"></i></a>
          </li><!-- <li><a class="icon" href="http://community.okta.com" target="_blank"><i class="fa fa-comments"></i></a></li> -->
        </ul>
      </div>
    </footer>
    <script type="text/javascript" src="/assets/master-d164e3cb90ad42ea74c141546269db0efdbc2259b7d44b7f52babb60097099a8.js"></script>
    
    
    
    

  <!-- START Post Footer -->
  
  <!-- START Google Tag Manager -->
  <!-- https://support.google.com/tagmanager/answer/6103696?hl=en -->
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- END Google Tag Manager -->
  <!-- START Google Remarketing Tag -->
  <script type="text/javascript">
    /* <![CDATA[ */
    var google_conversion_id = 1006913831;
    var google_custom_params = window.google_tag_params;
    var google_remarketing_only = true;
    /* ]]> */
  </script>
  <div style="display:none;"><script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js"></script></div>
  <noscript><div style="display:inline;"><img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/1006913831/?value=0&amp;guid=ON&amp;script=0"></div></noscript>
  <!-- END Google Remarketing Tag -->
  <!-- START Crazy Egg Tracking -->
  <script type="text/javascript">
    setTimeout(function(){var a=document.createElement("script");
    var b=document.getElementsByTagName("script")[0];
    a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0021/9333.js?"+Math.floor(new Date().getTime()/3600000);
    a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>
  <!-- END Crazy Egg Tracking -->

  <!-- END Post Footer -->
</body>
</html>
